---
title: "设置 SKAdNetwork 和转化值"
description: "为 iOS 应用配置 SKAdNetwork 功能。"
slug: "zh/sdk/unity/features/skad"
---

<Callout type="important">

此功能只可用于 iOS 14 及更高版本设备。

</Callout>

StoreKit Ad Network \(SKAdNetwork\) 是 Apple 的归因框架，可针对应用安装和重装进行归因。SKAdNetwork 的工作流程如下：

1. Apple 会收集归因信息，并通知相关广告渠道。
2. 然后，广告渠道会通过回调将这些信息传输给 Adjust。
3. Adjust 在 [Datascape](https://help.adjust.com/zh/suite/article/datascape) 中展示 SKAdNetwork 数据。

## 关闭 SKAdNetwork 通讯

```cs
public void deactivateSKAdNetworkHandling();
```

<MinorVersion added="v4.23.0">

v4\.23\.0 及以上版本的 Adjust SDK 会默认与 SKAdNetwork 通讯。SDK 在初始化时会注册 SKAdNetwork 归因。

</MinorVersion>

您的 config 对象包含一个`isSKAdNetworkHandlingActive` 布尔属性，该属性控制此行为。您可以通过 no 参数调用 `deactivateSKAdNetworkHandling` 方法来禁用 SKAdNetwork 通讯。

<Callout type="important">

您必须在初始化 Adjust SDK _之前_ 调用 `deactivateSKAdNetworkHandling` 方法。

</Callout>

```cs
AdjustConfig adjustConfig = new AdjustConfig("{YourAppToken}", AdjustEnvironment.Sandbox, true);
//...
adjustConfig.deactivateSKAdNetworkHandling();
//...
Adjust.start(adjustConfig);
```

## 更新转化值

```cs
public static void updateConversionValue(int conversionValue);
```

转化值是用来在 SKAdNetwork 中跟踪用户行为的机制。您可以将 64 个条件映射至 0\-63 的转化值，并在用户安装时将此整数值发送至 SKAdNetwork。该信息可帮助您进一步了解用户在安装后的最初几日内是如何与应用交互的。

If you manage your conversion values with Adjust, the servers update this value in the SDK. You can also update this value by using the `updateConversionValue` method. This method wraps [Apple's `updateConversionValue` method](https://developer.apple.com/documentation/storekit/skadnetwork/3566697-updateconversionvalue). It accepts an `int` argument representing your updated conversion value.

```cs
Adjust.updateConversionValue(6);
```

### 示例

该示例展示了如何在用户触发事件后将转化值更新为 `10`。

```cs
public void OnButtonClick() {
   Adjust.updateConversionValue(10);
}
```

## 监听转化值变更

```cs
public void setConversionValueUpdatedDelegate(Action<int id="sl-md0000000"> conversionValueUpdatedDelegate, string sceneName = "Adjust");
```

如果您使用 Adjust 管理转化值，那么 Adjust 服务器就会将转化值更新发送到 SDK。您可以设置委托函数，使用 `setConversionValueUpdatedDelegate` 方法监听更新。请以参数形式传送您的函数。

```cs
AdjustConfig adjustConfig = new AdjustConfig("{YourAppToken}", AdjustEnvironment.Sandbox, true);
//...
adjustConfig.setConversionValueUpdatedDelegate(ConversionValueUpdatedCallback);
//...
Adjust.start(adjustConfig);
```

### 示例

该示例展示了如何在转化值更新时记录下列内容：

-  确认转化值发生更新的消息
-  新的转化值

```cs
using com.adjust.sdk;

public class ExampleGUI : MonoBehaviour {
    void OnGUI() {
        if (GUI.Button(new Rect(0, 0, Screen.width, Screen.height), "callback")) {
            AdjustConfig adjustConfig = new AdjustConfig("{Your App Token}", AdjustEnvironment.Sandbox);
            adjustConfig.setLogLevel(AdjustLogLevel.Verbose);
            adjustConfig.setConversionValueUpdatedDelegate(ConversionValueUpdatedCallback);

            Adjust.start(adjustConfig);
        }
    }

    private void ConversionValueUpdatedCallback(int conversionValue) {
        Debug.Log("Conversion value updated. Callback received");
        Debug.Log("Conversion value: " + conversionValue);
    }
}
```
